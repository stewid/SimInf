<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Scheduled events • SimInf</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Scheduled events">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SimInf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">10.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/mparse.html">Getting started with `mparse`</a></li>
    <li><a class="dropdown-item" href="../articles/post-process-data.html">Post-process data in a trajectory</a></li>
    <li><a class="dropdown-item" href="../articles/scheduled-events.html">Scheduled events</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stewid/SimInf/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Scheduled events</h1>
                        <h4 data-toc-skip class="author">Stefan Widgren
<a href="https://orcid.org/0000-0001-5745-2284" class="external-link">
<img src="https://info.orcid.org/wp-content/uploads/2019/11/orcid_16x16.png" alt="ORCID logo" width="16" height="16" style="border-style:none;"></a>
</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stewid/SimInf/blob/main/vignettes/scheduled-events.Rmd" class="external-link"><code>vignettes/scheduled-events.Rmd</code></a></small>
      <div class="d-none name"><code>scheduled-events.Rmd</code></div>
    </div>

    
    
<p>NB: This vignette is work-in-progress and not yet complete.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette describes how births, deaths and movements can be
incorporated into a model as scheduled events at predefined time-points.
Events can, for example, be used to simulate disese spread among
multiple subpopulations (e.g., farms) when individuals can move between
the subpopulations and thus transfer infection, see Figure 1. In SimInf,
we use <code>node</code> to denote a subpopulation.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mspace width="0.222em"></mspace><annotation encoding="application/x-tex">~</annotation></semantics></math></p>
<div class="figure" style="text-align: left">
<img src="img/temporal-network.svg" class="r-plt" alt="**Figure 1.** Illustration of movements between nodes. Each time step depicts movements during one time unit, for example, a day. The network has *N=4* nodes where node *1* is infected and nodes *2*--*4* are non-infected. Arrows indicate movements of individuals from a source node to a destination node and labels denote the size of the shipment. Here, infection may spread from node *1* to node *3* at *t=2* and then from node *3* to node *2* at *t=3*." width="100%"><p class="caption">
<strong>Figure 1.</strong> Illustration of movements between nodes. Each
time step depicts movements during one time unit, for example, a day.
The network has <em>N=4</em> nodes where node <em>1</em> is infected and
nodes <em>2</em>–<em>4</em> are non-infected. Arrows indicate movements
of individuals from a source node to a destination node and labels
denote the size of the shipment. Here, infection may spread from node
<em>1</em> to node <em>3</em> at <em>t=2</em> and then from node
<em>3</em> to node <em>2</em> at <em>t=3</em>.
</p>
</div>
</div>
<div class="section level2">
<h2 id="a-first-example">A first example<a class="anchor" aria-label="anchor" href="#a-first-example"></a>
</h2>
<p>Let us define the <strong>6</strong> movement events in Figure 1 to
include them in an SIR model. Below is a <code>data.frame</code>, that
contains the movements. Interpret it as follows:</p>
<ol style="list-style-type: decimal">
<li>In time step <strong>1</strong> we move <strong>9</strong>
individuals from node <strong>3</strong> to node <strong>2</strong>
</li>
<li>In time step <strong>1</strong> we move <strong>2</strong>
individuals from node <strong>3</strong> to node <strong>4</strong>
</li>
<li>In time step <strong>2</strong> we move <strong>8</strong>
individuals from node <strong>1</strong> to node <strong>3</strong>
</li>
<li>In time step <strong>2</strong> we move <strong>3</strong>
individuals from node <strong>4</strong> to node <strong>3</strong>
</li>
<li>In time step <strong>3</strong> we move <strong>5</strong>
individuals from node <strong>3</strong> to node <strong>2</strong>
</li>
<li>In time step <strong>3</strong> we move <strong>4</strong>
individuals from node <strong>4</strong> to node <strong>2</strong>
</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  event      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"extTrans"</span>, <span class="fl">6</span><span class="op">)</span>,  <span class="co">## Event "extTrans" is</span></span>
<span>                                    <span class="co">##  a movement between nodes</span></span>
<span>  time       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, <span class="co">## The time that the event happens</span></span>
<span>  node       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="co">## In which node does the event occur</span></span>
<span>  dest       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co">## Which node is the destination node</span></span>
<span>  n          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">2</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">4</span><span class="op">)</span>, <span class="co">## How many individuals are moved</span></span>
<span>  proportion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co">## This is not used when n &gt; 0</span></span>
<span>  select     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="co">## Use the 4th column in</span></span>
<span>                                    <span class="co">## the model select matrix</span></span>
<span>  shift      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="co">## Not used in this example</span></span></code></pre></div>
<p>and have a look at the <code>data.frame</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">events</span></span></code></pre></div>
<pre><code><span><span class="co">##      event time node dest n proportion select shift</span></span>
<span><span class="co">## 1 extTrans    1    3    4 9          0      4     0</span></span>
<span><span class="co">## 2 extTrans    1    3    2 2          0      4     0</span></span>
<span><span class="co">## 3 extTrans    2    1    3 8          0      4     0</span></span>
<span><span class="co">## 4 extTrans    2    4    3 3          0      4     0</span></span>
<span><span class="co">## 5 extTrans    3    3    2 5          0      4     0</span></span>
<span><span class="co">## 6 extTrans    3    4    2 4          0      4     0</span></span></code></pre>
<p>Now, create an SIR model where we turn off the disease dynamics
(beta=0, gamma=0) to focus on the scheduled events. Let us start with
different number of individuals in each node.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stewid/SimInf" class="external-link">SimInf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SIR.html">SIR</a></span><span class="op">(</span>u0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>S <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>                             I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span><span class="op">)</span>,</span>
<span>                             R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             tspan <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>             beta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             gamma <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             events <span class="op">=</span> <span class="va">events</span><span class="op">)</span></span></code></pre></div>
<p>The compartments that an event operates on, is controlled by the
select value specified for each event together with the model select
matrix (E). Each row in E corresponds to one compartment in the model,
and the non-zero entries in a column indicate which compartments to
sample individuals from when processing an event. Which column to use in
E for an event is determined by the event select value. In this example,
we use the 4<sup>th</sup> column which means that all compartments can
be sampled in each movement event (see below).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">@</span><span class="va">events</span><span class="op">@</span><span class="va">E</span></span></code></pre></div>
<pre><code><span><span class="co">## 3 x 4 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">##   1 2 3 4</span></span>
<span><span class="co">## S 1 . . 1</span></span>
<span><span class="co">## I . 1 . 1</span></span>
<span><span class="co">## R . . 1 1</span></span></code></pre>
<p>In another case you might be interested in only targeting the
susceptibles, which means for this model that we select the first
column. Now, let us run the model and generate data from it. For
reproducibility, we first call the <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> function and
specify the number of threads to use since there is random sampling
involved when picking inviduals from the compartments.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/set_num_threads.html">set_num_threads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p>And plot (Figure 2) the number of individuals in each node.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, range <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="scheduled-events_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="**Figure 2.** Number of susceptible, infected and recovered individuals in each node." width="672"><p class="caption">
<strong>Figure 2.</strong> Number of susceptible, infected and recovered
individuals in each node.
</p>
</div>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mspace width="0.222em"></mspace><annotation encoding="application/x-tex">~</annotation></semantics></math></p>
<p>Or use the <code><a href="../reference/trajectory.html">trajectory()</a></code> function to more easily inspect
the outcome in each node in detail.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectory.html">trajectory</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    node time  S I R</span></span>
<span><span class="co">## 1     1    0 10 5 0</span></span>
<span><span class="co">## 2     2    0 15 0 0</span></span>
<span><span class="co">## 3     3    0 20 0 0</span></span>
<span><span class="co">## 4     4    0 25 0 0</span></span>
<span><span class="co">## 5     1    1 10 5 0</span></span>
<span><span class="co">## 6     2    1 17 0 0</span></span>
<span><span class="co">## 7     3    1  9 0 0</span></span>
<span><span class="co">## 8     4    1 34 0 0</span></span>
<span><span class="co">## 9     1    2  6 1 0</span></span>
<span><span class="co">## 10    2    2 17 0 0</span></span>
<span><span class="co">## 11    3    2 16 4 0</span></span>
<span><span class="co">## 12    4    2 31 0 0</span></span>
<span><span class="co">## 13    1    3  6 1 0</span></span>
<span><span class="co">## 14    2    3 25 1 0</span></span>
<span><span class="co">## 15    3    3 12 3 0</span></span>
<span><span class="co">## 16    4    3 27 0 0</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="varying-probability-of-picking-individuals">Varying probability of picking individuals<a class="anchor" aria-label="anchor" href="#varying-probability-of-picking-individuals"></a>
</h2>
<p>It is possible to assign different probabillities for the
compartments that an event sample individuals from. If the weights in
the select matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>E</mi><annotation encoding="application/x-tex">E</annotation></semantics></math>
are non-identical, individuals are sampled from a biased urn. To
illustrate this, let us create movement events between two nodes for the
built-in SIR model, where we start with 300 individuals
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">S = 100</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">I = 100</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">R = 100</annotation></semantics></math>)
in the first node and then move them, one by one, to the second
node.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>S <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                 I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                 R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"extTrans"</span>, <span class="fl">300</span><span class="op">)</span>, <span class="co">## Event "extTrans" is a movement between nodes</span></span>
<span>  time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">300</span>,                 <span class="co">## The time that the event happens</span></span>
<span>  node <span class="op">=</span> <span class="fl">1</span>,                     <span class="co">## In which node does the event occur</span></span>
<span>  dest <span class="op">=</span> <span class="fl">2</span>,                     <span class="co">## Which node is the destination node</span></span>
<span>  n <span class="op">=</span> <span class="fl">1</span>,                        <span class="co">## How many individuals are moved</span></span>
<span>  proportion <span class="op">=</span> <span class="fl">0</span>,               <span class="co">## This is not used when n &gt; 0</span></span>
<span>  select <span class="op">=</span> <span class="fl">4</span>,                   <span class="co">## Use the 4th column in the model select matrix</span></span>
<span>  shift <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>                    <span class="co">## Not used in this example</span></span></code></pre></div>
<p>Now, create the model. Then run it, and plot the number of
individuals in the second node.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SIR.html">SIR</a></span><span class="op">(</span>u0 <span class="op">=</span> <span class="va">u0</span>,</span>
<span>             tspan <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">300</span>,</span>
<span>             events <span class="op">=</span> <span class="va">events</span>,</span>
<span>             beta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             gamma <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="scheduled-events_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" alt="**Figure 3.** The individuals have an equal probability of being selected regardless of compartment." width="672"><p class="caption">
<strong>Figure 3.</strong> The individuals have an equal probability of
being selected regardless of compartment.
</p>
</div>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mspace width="0.222em"></mspace><annotation encoding="application/x-tex">~</annotation></semantics></math></p>
<p>The probability to sample an individual from each compartment is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>S</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mi>S</mi></msub><mo>*</mo><mi>S</mi></mrow><mrow><msub><mi>w</mi><mi>S</mi></msub><mo>*</mo><mi>S</mi><mo>+</mo><msub><mi>w</mi><mi>I</mi></msub><mo>*</mo><mi>I</mi><mo>+</mo><msub><mi>w</mi><mi>R</mi></msub><mo>*</mo><mi>R</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
p_S = \frac{w_S * S}{w_S * S + w_I * I + w_R * R}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>I</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mi>I</mi></msub><mo>*</mo><mi>I</mi></mrow><mrow><msub><mi>w</mi><mi>S</mi></msub><mo>*</mo><mi>S</mi><mo>+</mo><msub><mi>w</mi><mi>I</mi></msub><mo>*</mo><mi>I</mi><mo>+</mo><msub><mi>w</mi><mi>R</mi></msub><mo>*</mo><mi>R</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
p_I = \frac{w_I * I}{w_S * S + w_I * I + w_R * R}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>R</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>w</mi><mi>R</mi></msub><mo>*</mo><mi>R</mi></mrow><mrow><msub><mi>w</mi><mi>S</mi></msub><mo>*</mo><mi>S</mi><mo>+</mo><msub><mi>w</mi><mi>I</mi></msub><mo>*</mo><mi>I</mi><mo>+</mo><msub><mi>w</mi><mi>R</mi></msub><mo>*</mo><mi>R</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
p_R = \frac{w_R * R}{w_S * S + w_I * I + w_R * R}
</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>S</mi></msub><annotation encoding="application/x-tex">w_S</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>I</mi></msub><annotation encoding="application/x-tex">w_I</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>R</mi></msub><annotation encoding="application/x-tex">w_R</annotation></semantics></math>
are the weights in E. These probabilities are applied sequentially, that
is the probability of choosing the next item is proportional to the
weights amongst the remaining items. Let us now double the weight to
sample individuals from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
compartment and then run the model again.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">@</span><span class="va">events</span><span class="op">@</span><span class="va">E</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="scheduled-events_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" alt="**Figure 4.** The individuals in the $I$ compartment are more likely of being selected for a movement event." width="672"><p class="caption">
<strong>Figure 4.</strong> The individuals in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
compartment are more likely of being selected for a movement event.
</p>
</div>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mspace width="0.222em"></mspace><annotation encoding="application/x-tex">~</annotation></semantics></math></p>
<p>And a much larger weight to sample individuals from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
compartment.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">@</span><span class="va">events</span><span class="op">@</span><span class="va">E</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="scheduled-events_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" alt="**Figure 5.** The individuals in the $I$ compartment are even more likely of being selected for a movement event compared to the previous example." width="672"><p class="caption">
<strong>Figure 5.</strong> The individuals in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
compartment are even more likely of being selected for a movement event
compared to the previous example.
</p>
</div>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mspace width="0.222em"></mspace><annotation encoding="application/x-tex">~</annotation></semantics></math></p>
<p>Increase the weight for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
compartment and run the model again.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">@</span><span class="va">events</span><span class="op">@</span><span class="va">E</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="scheduled-events_files/figure-html/unnamed-chunk-14-1.png" class="r-plt" alt="**Figure 6.** The individuals in the $I$ and $R$ compartments are more likely of being selected for a movement event compared to individuals in the $S$ compartment." width="672"><p class="caption">
<strong>Figure 6.</strong> The individuals in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
compartments are more likely of being selected for a movement event
compared to individuals in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
compartment.
</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefan Widgren, Robin Eriksson, Stefan Engblom, Pavol Bauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
