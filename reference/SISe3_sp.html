<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create an SISe3_sp model — SISe3_sp • SimInf</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create an SISe3_sp model — SISe3_sp"><meta name="description" content="Create an SISe3_sp model to be used by the simulation
framework."><meta property="og:description" content="Create an SISe3_sp model to be used by the simulation
framework."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SimInf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">9.8.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mparse.html">Getting started with `mparse`</a></li>
    <li><a class="dropdown-item" href="../articles/post-process-data.html">Post-process data in a trajectory</a></li>
    <li><a class="dropdown-item" href="../articles/scheduled-events.html">Scheduled events</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stewid/SimInf/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create an <code>SISe3_sp</code> model</h1>
      <small class="dont-index">Source: <a href="https://github.com/stewid/SimInf/blob/main/R/SISe3_sp.R" class="external-link"><code>R/SISe3_sp.R</code></a></small>
      <div class="d-none name"><code>SISe3_sp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create an <code>SISe3_sp</code> model to be used by the simulation
framework.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SISe3_sp</span><span class="op">(</span></span>
<span>  <span class="va">u0</span>,</span>
<span>  <span class="va">tspan</span>,</span>
<span>  events <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  phi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upsilon_1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upsilon_2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upsilon_3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gamma_1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gamma_2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gamma_3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta_t1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta_t2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta_t3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta_t4 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_t1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_t2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_t3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_t4 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coupling <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-u-">u0<a class="anchor" aria-label="anchor" href="#arg-u-"></a></dt>
<dd><p>A <code>data.frame</code> with the initial state in each node,
i.e., the number of individuals in each compartment in each
node when the simulation starts (see ‘Details’). The
parameter <code>u0</code> can also be an object that can be coerced
to a <code>data.frame</code>, e.g., a named numeric vector will be
coerced to a one row <code>data.frame</code>.</p></dd>


<dt id="arg-tspan">tspan<a class="anchor" aria-label="anchor" href="#arg-tspan"></a></dt>
<dd><p>A vector (length &gt;= 1) of increasing time points
where the state of each node is to be returned. Can be either
an <code>integer</code> or a <code>Date</code> vector. A <code>Date</code>
vector is coerced to a numeric vector as days, where
<code>tspan[1]</code> becomes the day of the year of the first year
of <code>tspan</code>. The dates are added as names to the numeric
vector.</p></dd>


<dt id="arg-events">events<a class="anchor" aria-label="anchor" href="#arg-events"></a></dt>
<dd><p>a <code>data.frame</code> with the scheduled events, see
<code><a href="SimInf_model.html">SimInf_model</a></code>.</p></dd>


<dt id="arg-phi">phi<a class="anchor" aria-label="anchor" href="#arg-phi"></a></dt>
<dd><p>A numeric vector with the initial environmental
infectious pressure in each node. Will be repeated to the
length of nrow(u0). Default is NULL which gives 0 in each
node.</p></dd>


<dt id="arg-upsilon-">upsilon_1<a class="anchor" aria-label="anchor" href="#arg-upsilon-"></a></dt>
<dd><p>Indirect transmission rate of the environmental
infectious pressure in age category 1</p></dd>


<dt id="arg-upsilon-">upsilon_2<a class="anchor" aria-label="anchor" href="#arg-upsilon-"></a></dt>
<dd><p>Indirect transmission rate of the environmental
infectious pressure in age category 2</p></dd>


<dt id="arg-upsilon-">upsilon_3<a class="anchor" aria-label="anchor" href="#arg-upsilon-"></a></dt>
<dd><p>Indirect transmission rate of the environmental
infectious pressure in age category 3</p></dd>


<dt id="arg-gamma-">gamma_1<a class="anchor" aria-label="anchor" href="#arg-gamma-"></a></dt>
<dd><p>The recovery rate from infected to susceptible for
age category 1</p></dd>


<dt id="arg-gamma-">gamma_2<a class="anchor" aria-label="anchor" href="#arg-gamma-"></a></dt>
<dd><p>The recovery rate from infected to susceptible for
age category 2</p></dd>


<dt id="arg-gamma-">gamma_3<a class="anchor" aria-label="anchor" href="#arg-gamma-"></a></dt>
<dd><p>The recovery rate from infected to susceptible for
age category 3</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Shed rate from infected individuals</p></dd>


<dt id="arg-beta-t-">beta_t1<a class="anchor" aria-label="anchor" href="#arg-beta-t-"></a></dt>
<dd><p>The decay of the environmental infectious pressure
in interval 1.</p></dd>


<dt id="arg-beta-t-">beta_t2<a class="anchor" aria-label="anchor" href="#arg-beta-t-"></a></dt>
<dd><p>The decay of the environmental infectious pressure
in interval 2.</p></dd>


<dt id="arg-beta-t-">beta_t3<a class="anchor" aria-label="anchor" href="#arg-beta-t-"></a></dt>
<dd><p>The decay of the environmental infectious pressure
in interval 3.</p></dd>


<dt id="arg-beta-t-">beta_t4<a class="anchor" aria-label="anchor" href="#arg-beta-t-"></a></dt>
<dd><p>The decay of the environmental infectious pressure
in interval 4.</p></dd>


<dt id="arg-end-t-">end_t1<a class="anchor" aria-label="anchor" href="#arg-end-t-"></a></dt>
<dd><p>vector with the non-inclusive day of the year that
ends interval 1 in each node. Will be repeated to the length
of nrow(u0).</p></dd>


<dt id="arg-end-t-">end_t2<a class="anchor" aria-label="anchor" href="#arg-end-t-"></a></dt>
<dd><p>vector with the non-inclusive day of the year that
ends interval 2 in each node. Will be repeated to the length
of nrow(u0).</p></dd>


<dt id="arg-end-t-">end_t3<a class="anchor" aria-label="anchor" href="#arg-end-t-"></a></dt>
<dd><p>vector with the non-inclusive day of the year that
ends interval 3 in each node. Will be repeated to the length
of nrow(u0).</p></dd>


<dt id="arg-end-t-">end_t4<a class="anchor" aria-label="anchor" href="#arg-end-t-"></a></dt>
<dd><p>vector with the non-inclusive day of the year that
ends interval 4 in each node. Will be repeated to the length
of nrow(u0).</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>The distance matrix between neighboring nodes</p></dd>


<dt id="arg-coupling">coupling<a class="anchor" aria-label="anchor" href="#arg-coupling"></a></dt>
<dd><p>The coupling between neighboring nodes</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>SISe3_sp</code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>SISe3_sp</code> model contains two compartments in three age
categories; number of susceptible (S_1, S_2, S_3) and number of
infectious (I_1, I_2, I_3). Additionally, it contains an
environmental compartment to model shedding of a pathogen to the
environment. Moreover, it also includes a spatial coupling of the
environmental contamination among proximal nodes to capture
between-node spread unrelated to moving infected
individuals. Consequently, the model has six state transitions,</p>
<p>$$S_1 \stackrel{\upsilon_1 \varphi S_1}{\longrightarrow} I_1$$</p>
<p>$$I_1 \stackrel{\gamma_1 I_1}{\longrightarrow} S_1$$</p>
<p>$$S_2 \stackrel{\upsilon_2 \varphi S_2}{\longrightarrow} I_2$$</p>
<p>$$I_2 \stackrel{\gamma_2 I_2}{\longrightarrow} S_2$$</p>
<p>$$S_3 \stackrel{\upsilon_3 \varphi S_3}{\longrightarrow} I_3$$</p>
<p>$$I_3 \stackrel{\gamma_3 I_3}{\longrightarrow} S_3$$</p>
<p>where the transition rate per unit of time from susceptible to
infected is proportional to the concentration of the environmental
contamination \(\varphi\) in each node. Moreover, the
transition rate from infected to susceptible is the recovery rate
\(\gamma_1, \gamma_2, \gamma_3\), measured per individual and
per unit of time. Finally, the environmental infectious pressure
in each node is evolved by,</p>
<p>$$\frac{d \varphi_i(t)}{dt} = \frac{\alpha \left(I_{i,1}(t) +
I_{i,2}(t) + I_{i,3}(t)\right)}{N_i(t)} +
\sum_k{\frac{\varphi_k(t) N_k(t) - \varphi_i(t) N_i(t)}{N_i(t)}
\cdot \frac{D}{d_{ik}}} - \beta(t) \varphi_i(t)$$</p>
<p>where \(\alpha\) is the average shedding rate of the pathogen to
the environment per infected individual and \(N = S_1 + S_2 +
S_3 + I_1 + I_2 + I_3\) the size of the node. Next comes the
spatial coupling among proximal nodes, where \(D\) is the rate
of the local spread and \(d_{ik}\) the distance between holdings
\(i\) and \(k\). The seasonal decay and removal of the
pathogen is captured by \(\beta(t)\). The environmental
infectious pressure \(\varphi(t)\) in each node is
evolved each time unit by the Euler forward method. The value of
\(\varphi(t)\) is saved at the time-points specified in
<code>tspan</code>.</p>
<p>The argument <code>u0</code> must be a <code>data.frame</code> with one row for
each node with the following columns:</p><dl><dt>S_1</dt>
<dd><p>The number of sucsceptible in age category 1</p></dd>

<dt>I_1</dt>
<dd><p>The number of infected in age category 1</p></dd>

<dt>S_2</dt>
<dd><p>The number of sucsceptible in age category 2</p></dd>

<dt>I_2</dt>
<dd><p>The number of infected in age category 2</p></dd>

<dt>S_3</dt>
<dd><p>The number of sucsceptible in age category 3</p></dd>

<dt>I_3</dt>
<dd><p>The number of infected in age category 3</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="beta">Beta<a class="anchor" aria-label="anchor" href="#beta"></a></h2>


<p>The time dependent beta is divided into four intervals of the year</p><div class="sourceCode"><pre><code>
where 0 &lt;= day &lt; 365

Case 1: END_1 &lt; END_2 &lt; END_3 &lt; END_4
INTERVAL_1 INTERVAL_2     INTERVAL_3     INTERVAL_4     INTERVAL_1
[0, END_1) [END_1, END_2) [END_2, END_3) [END_3, END_4) [END_4, 365)

Case 2: END_3 &lt; END_4 &lt; END_1 &lt; END_2
INTERVAL_3 INTERVAL_4     INTERVAL_1     INTERVAL_2     INTERVAL_3
[0, END_3) [END_3, END_4) [END_4, END_1) [END_1, END_2) [END_2, 365)

Case 3: END_4 &lt; END_1 &lt; END_2 &lt; END_3
INTERVAL_4 INTERVAL_1     INTERVAL_2     INTERVAL_3     INTERVAL_4
[0, END_4) [END_4, END_1) [END_1, END_2) [END_2, END_3) [END_3, 365)
</code></pre></div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefan Widgren, Robin Eriksson, Stefan Engblom, Pavol Bauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

