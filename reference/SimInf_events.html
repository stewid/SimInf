<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a SimInf_events object — SimInf_events • SimInf</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a SimInf_events object — SimInf_events"><meta name="description" content="The argument events must be a data.frame with the following
columns:
  event
Four event types are supported by the current solvers:
    exit, enter, internal transfer, and
    external transfer.  When assigning the events, they can
    either be coded as a numerical value or a character string:
    exit; 0 or 'exit', enter; 1
    or 'enter', internal transfer; 2 or
    'intTrans', and external transfer; 3 or
    'extTrans'.  Internally in SimInf, the event type
    is coded as a numerical value.

  time
When the event occurs i.e., the event is processed when time
    is reached in the simulation. Can be either an integer
    or a Date vector.  A Date vector is coerced to a
    numeric vector as days, where t0 determines the offset
    to match the time of the events to the model tspan
    vector.

  node
The node that the event operates on. Also the source node for
    an external transfer event.
    1 &amp;lt;= node[i] &amp;lt;= Number of nodes.

  dest
The destination node for an external transfer event
    i.e., individuals are moved from node to dest,
    where 1 &amp;lt;= dest[i] &amp;lt;= Number of nodes.  Set event
    = 0 for the other event types.  dest is an integer
    vector.

  n
The number of individuals affected by the event. n[i] &amp;gt;= 0.

  proportion
If n[i] equals zero, the number of individuals affected
    by event[i] is calculated by sampling the number of
    individuals from a binomial distribution using the
    proportion[i] and the number of individuals in the
    compartments. Numeric vector.  0 &amp;lt;= proportion[i] &amp;lt;= 1.

  select
To process an event[i], the compartments affected by
    the event are specified with select[i] together with
    the matrix E, where select[i] determines which
    column in E to use.  The specific individuals affected
    by the event are sampled from the compartments corresponding
    to the non-zero entries in the specified column in E[,
    select[i]], where select is an integer vector.

  shift
Determines how individuals in internal transfer and
    external transfer events are shifted to enter another
    compartment.  The sampled individuals are shifted according to
    column shift[i] in matrix N i.e., N[,
    shift[i]], where shift is an integer vector.  See
    above for a description of N. Unsued for the other
    event types.



"><meta property="og:description" content="The argument events must be a data.frame with the following
columns:
  event
Four event types are supported by the current solvers:
    exit, enter, internal transfer, and
    external transfer.  When assigning the events, they can
    either be coded as a numerical value or a character string:
    exit; 0 or 'exit', enter; 1
    or 'enter', internal transfer; 2 or
    'intTrans', and external transfer; 3 or
    'extTrans'.  Internally in SimInf, the event type
    is coded as a numerical value.

  time
When the event occurs i.e., the event is processed when time
    is reached in the simulation. Can be either an integer
    or a Date vector.  A Date vector is coerced to a
    numeric vector as days, where t0 determines the offset
    to match the time of the events to the model tspan
    vector.

  node
The node that the event operates on. Also the source node for
    an external transfer event.
    1 &amp;lt;= node[i] &amp;lt;= Number of nodes.

  dest
The destination node for an external transfer event
    i.e., individuals are moved from node to dest,
    where 1 &amp;lt;= dest[i] &amp;lt;= Number of nodes.  Set event
    = 0 for the other event types.  dest is an integer
    vector.

  n
The number of individuals affected by the event. n[i] &amp;gt;= 0.

  proportion
If n[i] equals zero, the number of individuals affected
    by event[i] is calculated by sampling the number of
    individuals from a binomial distribution using the
    proportion[i] and the number of individuals in the
    compartments. Numeric vector.  0 &amp;lt;= proportion[i] &amp;lt;= 1.

  select
To process an event[i], the compartments affected by
    the event are specified with select[i] together with
    the matrix E, where select[i] determines which
    column in E to use.  The specific individuals affected
    by the event are sampled from the compartments corresponding
    to the non-zero entries in the specified column in E[,
    select[i]], where select is an integer vector.

  shift
Determines how individuals in internal transfer and
    external transfer events are shifted to enter another
    compartment.  The sampled individuals are shifted according to
    column shift[i] in matrix N i.e., N[,
    shift[i]], where shift is an integer vector.  See
    above for a description of N. Unsued for the other
    event types.



"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SimInf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">9.8.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mparse.html">Getting started with `mparse`</a></li>
    <li><a class="dropdown-item" href="../articles/post-process-data.html">Post-process data in a trajectory</a></li>
    <li><a class="dropdown-item" href="../articles/scheduled-events.html">Scheduled events</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stewid/SimInf/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a <code><a href="SimInf_events-class.html">SimInf_events</a></code> object</h1>
      <small class="dont-index">Source: <a href="https://github.com/stewid/SimInf/blob/main/R/SimInf_events.R" class="external-link"><code>R/SimInf_events.R</code></a></small>
      <div class="d-none name"><code>SimInf_events.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The argument events must be a <code>data.frame</code> with the following
columns:</p><dl><dt>event</dt>
<dd><p>Four event types are supported by the current solvers:
    <em>exit</em>, <em>enter</em>, <em>internal transfer</em>, and
    <em>external transfer</em>.  When assigning the events, they can
    either be coded as a numerical value or a character string:
    <em>exit;</em> <code>0</code> or <code>'exit'</code>, <em>enter;</em> <code>1</code>
    or <code>'enter'</code>, <em>internal transfer;</em> <code>2</code> or
    <code>'intTrans'</code>, and <em>external transfer;</em> <code>3</code> or
    <code>'extTrans'</code>.  Internally in <span class="pkg">SimInf</span>, the event type
    is coded as a numerical value.</p></dd>

  <dt>time</dt>
<dd><p>When the event occurs i.e., the event is processed when time
    is reached in the simulation. Can be either an <code>integer</code>
    or a <code>Date</code> vector.  A <code>Date</code> vector is coerced to a
    numeric vector as days, where <code>t0</code> determines the offset
    to match the time of the events to the model <code>tspan</code>
    vector.</p></dd>

  <dt>node</dt>
<dd><p>The node that the event operates on. Also the source node for
    an <em>external transfer</em> event.
    1 &lt;= <code>node[i]</code> &lt;= Number of nodes.</p></dd>

  <dt>dest</dt>
<dd><p>The destination node for an <em>external transfer</em> event
    i.e., individuals are moved from <code>node</code> to <code>dest</code>,
    where 1 &lt;= <code>dest[i]</code> &lt;= Number of nodes.  Set <code>event
    = 0</code> for the other event types.  <code>dest</code> is an integer
    vector.</p></dd>

  <dt>n</dt>
<dd><p>The number of individuals affected by the event. n[i] &gt;= 0.</p></dd>

  <dt>proportion</dt>
<dd><p>If <code>n[i]</code> equals zero, the number of individuals affected
    by <code>event[i]</code> is calculated by sampling the number of
    individuals from a binomial distribution using the
    <code>proportion[i]</code> and the number of individuals in the
    compartments. Numeric vector.  0 &lt;= proportion[i] &lt;= 1.</p></dd>

  <dt>select</dt>
<dd><p>To process an <code>event[i]</code>, the compartments affected by
    the event are specified with <code>select[i]</code> together with
    the matrix <code>E</code>, where <code>select[i]</code> determines which
    column in <code>E</code> to use.  The specific individuals affected
    by the event are sampled from the compartments corresponding
    to the non-zero entries in the specified column in <code>E[,
    select[i]]</code>, where <code>select</code> is an integer vector.</p></dd>

  <dt>shift</dt>
<dd><p>Determines how individuals in <em>internal transfer</em> and
    <em>external transfer</em> events are shifted to enter another
    compartment.  The sampled individuals are shifted according to
    column <code>shift[i]</code> in matrix <code>N</code> i.e., <code>N[,
    shift[i]]</code>, where <code>shift</code> is an integer vector.  See
    above for a description of <code>N</code>. Unsued for the other
    event types.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SimInf_events</span><span class="op">(</span>E <span class="op">=</span> <span class="cn">NULL</span>, N <span class="op">=</span> <span class="cn">NULL</span>, events <span class="op">=</span> <span class="cn">NULL</span>, t0 <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-e">E<a class="anchor" aria-label="anchor" href="#arg-e"></a></dt>
<dd><p>Each row corresponds to one compartment in the model. The
non-zero entries in a column indicates the compartments to
include in an event.  For the <em>exit</em>, <em>internal
transfer</em> and <em>external transfer</em> events, a non-zero
entry indicate the compartments to sample individuals from.
For the <em>enter</em> event, all individuals enter first
non-zero compartment. <code>E</code> is sparse matrix of class
<code><a href="https://rdrr.io/pkg/Matrix/man/dgCMatrix-class.html" class="external-link">dgCMatrix</a></code>.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Determines how individuals in <em>internal transfer</em>
and <em>external transfer</em> events are shifted to enter
another compartment.  Each row corresponds to one compartment
in the model.  The values in a column are added to the current
compartment of sampled individuals to specify the destination
compartment, for example, a value of <code>1</code> in an entry
means that sampled individuals in this compartment are moved
to the next compartment.  Which column to use for each event
is specified by the <code>shift</code> vector (see below).  <code>N</code>
is an integer matrix.</p></dd>


<dt id="arg-events">events<a class="anchor" aria-label="anchor" href="#arg-events"></a></dt>
<dd><p>A <code>data.frame</code> with events.</p></dd>


<dt id="arg-t-">t0<a class="anchor" aria-label="anchor" href="#arg-t-"></a></dt>
<dd><p>If <code>events$time</code> is a <code>Date</code> vector, then
<code>t0</code> determines the offset to match the time of the
events to the model <code>tspan</code> vector, see details. If
<code>events$time</code> is a numeric vector, then <code>t0</code> must be
<code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>S4 class <code>SimInf_events</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Let us illustrate how movement events can be used to transfer</span></span></span>
<span class="r-in"><span><span class="co">## individuals from one node to another.  Use the built-in SIR</span></span></span>
<span class="r-in"><span><span class="co">## model and start with 2 nodes where all individuals are in the</span></span></span>
<span class="r-in"><span><span class="co">## first node (100 per compartment).</span></span></span>
<span class="r-in"><span><span class="va">u0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>S <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>, I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>, R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Then create 300 movement events to transfer all individuals,</span></span></span>
<span class="r-in"><span><span class="co">## one per day, from the first node to the second node. Use the</span></span></span>
<span class="r-in"><span><span class="co">## fourth column in the select matrix where all compartments</span></span></span>
<span class="r-in"><span><span class="co">## can be sampled with equal weight.</span></span></span>
<span class="r-in"><span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>event      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"extTrans"</span>, <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     time       <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">300</span>,</span></span>
<span class="r-in"><span>                     node       <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                     dest       <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                     n          <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                     proportion <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                     select     <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                     shift      <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create an SIR model without disease transmission to</span></span></span>
<span class="r-in"><span><span class="co">## demonstrate the events.</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="SIR.html">SIR</a></span><span class="op">(</span>u0      <span class="op">=</span> <span class="va">u0</span>,</span></span>
<span class="r-in"><span>             tspan  <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">300</span>,</span></span>
<span class="r-in"><span>             events <span class="op">=</span> <span class="va">events</span>,</span></span>
<span class="r-in"><span>             beta   <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>             gamma  <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Run the model and plot the number of individuals in</span></span></span>
<span class="r-in"><span><span class="co">## the second node.  As can be seen in the figure, all</span></span></span>
<span class="r-in"><span><span class="co">## indivuduals have been moved to the second node when</span></span></span>
<span class="r-in"><span><span class="co">## t = 300.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="run.html">run</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, range <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SimInf_events-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Let us now double the weight to sample from the 'I'</span></span></span>
<span class="r-in"><span><span class="co">## compartment and rerun the model.</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">@</span><span class="va">events</span><span class="op">@</span><span class="va">E</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="run.html">run</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, range <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SimInf_events-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## And much larger weight to sample from the I compartment.</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">@</span><span class="va">events</span><span class="op">@</span><span class="va">E</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="run.html">run</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, range <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SimInf_events-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Increase the weight for the R compartment.</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">@</span><span class="va">events</span><span class="op">@</span><span class="va">E</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="run.html">run</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, range <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SimInf_events-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefan Widgren, Robin Eriksson, Stefan Engblom, Pavol Bauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

