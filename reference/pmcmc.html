<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Particle Markov chain Monte Carlo (PMCMC) algorithm — pmcmc • SimInf</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Particle Markov chain Monte Carlo (PMCMC) algorithm — pmcmc"><meta name="description" content="Particle Markov chain Monte Carlo (PMCMC) algorithm"><meta property="og:description" content="Particle Markov chain Monte Carlo (PMCMC) algorithm"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SimInf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">9.8.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mparse.html">Getting started with `mparse`</a></li>
    <li><a class="dropdown-item" href="../articles/post-process-data.html">Post-process data in a trajectory</a></li>
    <li><a class="dropdown-item" href="../articles/scheduled-events.html">Scheduled events</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stewid/SimInf/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Particle Markov chain Monte Carlo (PMCMC) algorithm</h1>
      <small class="dont-index">Source: <a href="https://github.com/stewid/SimInf/blob/main/R/pmcmc.R" class="external-link"><code>R/pmcmc.R</code></a></small>
      <div class="d-none name"><code>pmcmc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Particle Markov chain Monte Carlo (PMCMC) algorithm</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pmcmc</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">obs_process</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">priors</span>,</span>
<span>  <span class="va">n_particles</span>,</span>
<span>  <span class="va">n_iterations</span>,</span>
<span>  theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adaptmix <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  adaptive <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  init_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  post_particle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"verbose"</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SimInf_model'</span></span>
<span><span class="fu">pmcmc</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">obs_process</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">priors</span>,</span>
<span>  <span class="va">n_particles</span>,</span>
<span>  <span class="va">n_iterations</span>,</span>
<span>  theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adaptmix <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  adaptive <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  init_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  post_particle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"verbose"</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>The model to simulate data from.</p></dd>


<dt id="arg-obs-process">obs_process<a class="anchor" aria-label="anchor" href="#arg-obs-process"></a></dt>
<dd><p>Specification of the stochastic observation
process. The <code>obs_process</code> can be specified as a
<code>formula</code> if the model contains only one node and there
is only one data point for each <code>time</code> in <code>data</code>.
The left hand side of the formula must match a column name in
the <code>data</code> data.frame and the right hand side of the
formula is a character specifying the distribution of the
observation process, for example, <code>Iobs ~ poisson(I)</code>.
The following distributions are supported: <code>x ~
binomial(size, prob)</code>, <code>x ~ poisson(rate)</code> and <code>x ~
uniform(min, max)</code>. The observation process can also be a
function to evaluate the probability density of the
observations given the simulated states. The first argument
passed to the <code>obs_process</code> function is the result from a
run of the model and it contains one trajectory with simulated
data for a time-point. The second argument to the
<code>obs_process</code> function is a <code>data.frame</code> containing
the rows for the specific time-point that the function is
called for. Note that the function must return the log of the
density.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>data.frame</code> holding the time series data.</p></dd>


<dt id="arg-priors">priors<a class="anchor" aria-label="anchor" href="#arg-priors"></a></dt>
<dd><p>The priors for the parameters to fit. Each prior is
specified with a formula notation, for example, <code>beta ~
uniform(0, 1)</code> specifies that beta is uniformly distributed
between 0 and 1. Use <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> to provide more than one
prior, for example, <code>c(beta ~ uniform(0, 1), gamma ~
normal(10, 1))</code>. The following distributions are supported:
<code>gamma</code>, <code>lognormal</code>, <code>normal</code> and
<code>uniform</code>. All parameters in <code>priors</code> must be only
in either <code>gdata</code> or <code>ldata</code>.</p></dd>


<dt id="arg-n-particles">n_particles<a class="anchor" aria-label="anchor" href="#arg-n-particles"></a></dt>
<dd><p>An integer with the number of particles (&gt; 1)
to use at each timestep.</p></dd>


<dt id="arg-n-iterations">n_iterations<a class="anchor" aria-label="anchor" href="#arg-n-iterations"></a></dt>
<dd><p>An integer specifying the number of iterations
to run the PMCMC.</p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>A named vector of initial values for the parameters
of the model.  Default is <code>NULL</code>, and then these are
sampled from the prior distribution(s).</p></dd>


<dt id="arg-covmat">covmat<a class="anchor" aria-label="anchor" href="#arg-covmat"></a></dt>
<dd><p>A named numeric <code>(npars x npars)</code> matrix with
covariances to use as initial proposal matrix. If left
unspecified then defaults to <code>diag((theta/10)^2/npars)</code>.</p></dd>


<dt id="arg-adaptmix">adaptmix<a class="anchor" aria-label="anchor" href="#arg-adaptmix"></a></dt>
<dd><p>Mixing proportion for adaptive proposal.  Must be
a value between zero and one. Default is <code>adaptmix =
0.05</code>.</p></dd>


<dt id="arg-adaptive">adaptive<a class="anchor" aria-label="anchor" href="#arg-adaptive"></a></dt>
<dd><p>Controls when to start adaptive update. Must be
greater or equal to zero. If <code>adaptive=0</code>, then adaptive
update is not performed. Default is <code>adaptive = 100</code>.</p></dd>


<dt id="arg-init-model">init_model<a class="anchor" aria-label="anchor" href="#arg-init-model"></a></dt>
<dd><p>An optional function that, if non-NULL, is
applied before running each proposal. The function must accept
one argument of type <code>SimInf_model</code> with the current
model of the fitting process. This function can be useful to
specify the initial state of <code>u0</code> or <code>v0</code> of the
model before running a trajectory with proposed parameters.</p></dd>


<dt id="arg-post-particle">post_particle<a class="anchor" aria-label="anchor" href="#arg-post-particle"></a></dt>
<dd><p>An optional function that, if non-NULL, is
applied after each completed particle. The function must
accept three arguments: 1) an object of <code>SimInf_pmcmc</code>
with the current state of the fitting process, 2) an object
<code>SimInf_pfilter</code> with the last particle and one filtered
trajectory attached, and 3) an integer with the iteration in
the fitting process. This function can be useful to, for
example, monitor, save and inspect intermediate results.</p></dd>


<dt id="arg-chain">chain<a class="anchor" aria-label="anchor" href="#arg-chain"></a></dt>
<dd><p>An optional chain to start from. Must be a
<code>data.frame</code> or an object that can be coerced to a
<code>data.frame</code>. Only the columns in <code>chain</code> with a
name that matches the names that will be used if this argument
is not provided will be used. When this argument is provided,
<code>n_iterations</code> can be 0.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>prints diagnostic messages when <code>TRUE</code>. The
default is to retrieve the global option <code>verbose</code> and
use <code>FALSE</code> if it is not set. When <code>verbose=TRUE</code>,
information is printed every 100 iterations. For pmcmc, it is
possible to get information every nth information by
specifying <code>verbose=n</code>, for example, <code>verbose=1</code> or
<code>verbose=10</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>2010</p>
<p>2009</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="continue_pmcmc.html">continue_pmcmc</a></code>.</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefan Widgren, Robin Eriksson, Stefan Engblom, Pavol Bauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

